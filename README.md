# Java 实体类（POJO）和 Map 之间的相互转换

### auto-mapping-map 使用方法

1.在项目中的 `.pom` 文件中添加：

```xml
<properties>
   <auto-mapping-map.version>2.5</auto-mapping-map.version>
</properties>

<dependencys>
    <dependency>
      <groupId>io.github.anqinworks</groupId>
      <artifactId>auto-mapping-map</artifactId>
      <version>${auto-mapping-map.version}</version>
   </dependency>
</dependencys>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.8.1</version>
                <configuration>
                    <source>1.8</source>
                    <target>1.8</target>
                    <encoding>UTF-8</encoding>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>io.github.anqinworks</groupId>
                            <artifactId>auto-mapping-map</artifactId>
                            <version>${auto-mapping-map.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>
        </plugins>
    </build>
```
2.在需要映射的实体类上添加注解：`@cc.anqin.processor.annotation.AutoToMap`.注意：``实体类字段必须要有 Get,Set 方法`` 如添加 `@Data` 注解：
```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@AutoToMap
public class User {

    private String name;
    private int age;
    private String phone;
    private String address;
    private List<User> friends;
}

```
4.重新编译项目工程，生成效果如下：
```java
@Generated(
        value = "cc.anqin.processor.MapConverterProcessor",
        date = "2025-03-06T17:42:12.411",
        comments = "Generated by MapConverterProcessor; Introduction: https://anqin.cc/"
)
public class org_example_User_MapConverter implements MappingConvert<User> {
    @Override
    public Map<String, Object> toMap(User entity) {
        if (entity == null) {
            return Collections.emptyMap();
        }
        Map<String, Object> map = new HashMap<>();
        map.put("name", entity.getName());
        map.put("age", entity.getAge());
        map.put("phone", entity.getPhone());
        map.put("address", entity.getAddress());
        map.put("friends", entity.getFriends());
        return map;
    }

    @Override
    public User toBean(Map<String, Object> dataMap) {
        if (CollUtil.isEmpty(dataMap)) {
            return new User();
        }
        User bean = new User();
        bean.setName((String) dataMap.get("name"));
        bean.setAge((int) dataMap.get("age"));
        bean.setPhone((String) dataMap.get("phone"));
        bean.setAddress((String) dataMap.get("address"));
        bean.setFriends((List<User>) dataMap.get("friends"));
        return bean;
    }
}
```
5.通过`@AutoKeyMapping`进行映射和忽略：
```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@AutoToMap
public class User {

    @AutoKeyMapping(target = "username") // 在 toMap 时，将 name 映射为 username
    private String name;

    @IgnoreToBean // 在 toBean 时，忽略该字段
    private int age;

    @IgnoreToMap //  在 toMap 时，忽略该字段
    private String phone;

    @AutoKeyMapping(ignore = true) // 在 toMap 和 toBean 时，忽略该字段
    private String address;

    @IgnoreToMap
    @IgnoreToBean  // 在 toMap 和 toBean 时，忽略该字段
    private String email;

    private List<User> friends;
}


// 重新编译效果:
@Generated(
        value = "cc.anqin.processor.MapConverterProcessor",
        date = "2025-03-06T17:49:30.869",
        comments = "Generated by MapConverterProcessor; Introduction: https://anqin.cc/"
)
public class org_example_User_MapConverter implements MappingConvert<User> {
    @Override
    public Map<String, Object> toMap(User entity) {
        if (entity == null) {
            return Collections.emptyMap();
        }
        Map<String, Object> map = new HashMap<>();
        map.put("username", entity.getName());
        map.put("age", entity.getAge());
        map.put("friends", entity.getFriends());
        return map;
    }

    @Override
    public User toBean(Map<String, Object> dataMap) {
        if (CollUtil.isEmpty(dataMap)) {
            return new User();
        }
        User bean = new User();
        bean.setName((String) dataMap.get("name"));
        bean.setPhone((String) dataMap.get("phone"));
        bean.setFriends((List<User>) dataMap.get("friends"));
        return bean;
    }
}

```
6.调用，直接使用工厂类 `ConvertMap.toMap(Object source, Class<?> clazz)` 或 `ConvertMap.toBean(Map<String,Object> dataMap, Class<?> clazz)` 调用，如：
```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@AutoToMap
public class User {

    private String name;
    private int age;
    private String phone;
    private String address;
    private String email;
    private List<User> friends;

    public static void main(String[] args) {

        User user = new User();
        user.setName("张三");
        user.setAddress("陕西");
        user.setAge(15);
        user.setEmail("123@qq.com");
        user.setPhone("123456789");
        user.setFriends(ListUtil.of(
                        new User("李四", 12, "123456789", "123@qq.com", "陕西", ListUtil.of(
                                new User("王五", 13, "123456789", "123@qq.com", "陕西", ListUtil.of()))),
                        new User("赵六", 14, "123456789", "123@qq.com", "陕西", ListUtil.of(
                                new User("钱七", 15, "123456789", "123@qq.com", "陕西", ListUtil.of())))
                )
        );

        Map<String, Object> map = ConvertMap.toMap(user, User.class);
        System.out.println("将 实体 映射成 Map：" + JSONUtil.toJsonStr(map));

        System.out.println("\n-----------------------\n");

        System.out.println("将 Map 映射成 实体" + JSONUtil.toJsonStr(ConvertMap.toBean(map, User.class)));

    }
}

```
打印效果：  将 实体 映射成 Map
``` json
{
    "address": "陕西",
    "phone": "123456789",
    "name": "张三",
    "age": 15,
    "email": "123@qq.com",
    "friends": [
        {
            "name": "李四",
            "age": 12,
            "phone": "123456789",
            "address": "123@qq.com",
            "email": "陕西",
            "friends": [
                {
                    "name": "王五",
                    "age": 13,
                    "phone": "123456789",
                    "address": "123@qq.com",
                    "email": "陕西",
                    "friends": []
                }
            ]
        },
        {
            "name": "赵六",
            "age": 14,
            "phone": "123456789",
            "address": "123@qq.com",
            "email": "陕西",
            "friends": [
                {
                    "name": "钱七",
                    "age": 15,
                    "phone": "123456789",
                    "address": "123@qq.com",
                    "email": "陕西",
                    "friends": []
                }
            ]
        }
    ]
}
```
将 Map 映射成 实体User
```json
{
    "name": "张三",
    "age": 15,
    "phone": "123456789",
    "address": "陕西",
    "email": "123@qq.com",
    "friends": [
        {
            "name": "李四",
            "age": 12,
            "phone": "123456789",
            "address": "123@qq.com",
            "email": "陕西",
            "friends": [
                {
                    "name": "王五",
                    "age": 13,
                    "phone": "123456789",
                    "address": "123@qq.com",
                    "email": "陕西",
                    "friends": []
                }
            ]
        },
        {
            "name": "赵六",
            "age": 14,
            "phone": "123456789",
            "address": "123@qq.com",
            "email": "陕西",
            "friends": [
                {
                    "name": "钱七",
                    "age": 15,
                    "phone": "123456789",
                    "address": "123@qq.com",
                    "email": "陕西",
                    "friends": []
                }
            ]
        }
    ]
}
```

